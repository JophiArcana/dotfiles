desc: Homogeneous polynomial evaluates to 1
source: IMO 2017/6
tags: [2020-04, oly, tricky, nt, polynomial, intpoly, free, nice]

---

An ordered pair $(x,y)$ of integers is a \emph{primitive point} if $\gcd(x,y)=1$. Given a finite set $S$ of primitive points, prove that there exist a positive integer $n$ and integers $a_0$, $a_1$, $\ldots$, $a_n$ such that for each $(x,y)\in S$, we have \[a_0x^n+a_1x^{n-1}y+a_2x^{n-2}y^2+\cdots+a_{n-1}xy^{n-1}+a_ny^n=1.\]

---

In English, we want to prove that for any set of irreducible lattice points, there is a nonconstant homogeneous polynomial $P\in\mathbb Z[x,y]$ such that $P(x,y)=1$ for all $(x,y)\in S$.

We induct on $|S|$, with the base case $|S|=1$ being B\'ezout's lemma. Assume that for some set $S=\{(x_1,y_1),\ldots,(x_{k-1},y_{k-1})\}$ of irreducible lattice points, we have $P(x_i,y_i)$ for $i=1,\ldots,k-1$. The goal is to prove for each choice of $(x_k,y_k)\notin S$, there is a polynomial $Q$ such that $Q(x_i,y_i)$ for $i=1,\ldots,k$.

Let $n=\deg P$ and let $ax_k+by_k=1$, where $a$, $b$ exist by B\'ezout's lemma. We will exhibit a polynomial of the form \[Q(x,y)=P(x,y)^U+C\cdot(ax+by)^V\prod_{i=1}^{k-1}\left(y_i\cdot x-x_i\cdot y\right),\]
where $A$ is an integer and $nU=V+(k-1)$. 

By design, $Q(x_i,y_i)=1$ for $i=1,\ldots,k-1$, so it will suffice to find $U$, $C$ such that $Q(x_k,y_k)=1$.

If $y_ix_k-x_iy_k=0$ for some $i$, then since $(x_k,y_k)\ne(x_i,y_i)$, we have $x_k=-x_i$, $y_k=-y_i$. Then take $M=2$ and win. Henceforth $y_ix_k-x_iy_k\ne0$ for all $i$.
\begin{claim*}
    $P(x_k,y_k)$ and $y_ix_k-x_iy_k$ are relatively prime for all $i=1,\ldots,k-1$.
\end{claim*}
\begin{proof}
    Assume $p\mid y_ix_k-x_iy_k$. If $p\mid x_k$, then $p\nmid y_k$, so apply the below argument with $x$, $y$ swapped. In what follows, $p\nmid x_k$ (and thus $p\nmid x_i$).

    Then we have $y_k/x_k\equiv y_i/x_i\pmod p$, so
    \begin{align*}
        P(x_k,y_k)&\equiv\sum_{j=0}^na_jx_k^{n-j}y_k^j
        \equiv x_k^n\sum_{j=0}^na_j\left(\frac{y_k}{x_k}\right)^j
        \equiv x_k^n\sum_{j=0}^na_j\left(\frac{y_i}{x_i}\right)^j\\
        &\equiv\left(\frac{x_k}{x_i}\right)^nP(x_i,y_i)
        \equiv\left(\frac{x_k}{x_i}\right)^n
        \not\equiv0\pmod p,
    \end{align*}
    which proves the claim.
\end{proof}

Since $ax_k+by_k=1$, we have $P(x_k,y_k)$ and $(ax_k+by_k)^v\prod_{i=1}^{k-1}(y_ix_k-x_iy_k)$ are relatively prime. Take $U$ a large multiple of $2\vphi\left(\prod_{i=1}^{i-1}(y_ix_k-x_iy_k)\right)$, so that $nU\ge k-1$ and there is an integer $C$ for which $Q(x_k,y_k)=1$. This completes the proof.

