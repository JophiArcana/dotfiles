desc: Size of rectangle with no primitive point
source: USAMO 2014/6
tags: [2020-04, oly, hard, nt, size]

---

Prove that there is a constant $c>0$ with the following property: If $a$, $b$, $n$ are positive integers such that $\gcd(a+i,b+j)>1$ for all $i,j\in\{0,1,\ldots,n\}$, then \[\min\{a,b\}>(cn)^{n/2}.\]

---

To simplify computation, we only use $i,j\in\{1,\ldots,n\}$. We will prove the stronger bound $\min\{a,b\}>(cn)^n$ for sufficiently large $n$.

Let $\veps=10^{-10}$ be small. Consider the $n\times n$ grid defined by the points $(a+i,b+j)$ where $i,j\in\{1,\ldots,n\}$, and in each cell place the least prime factor of $\gcd(a+i,b+j)$. Note that each prime $p$ divides at most $(1+n/p)^2$ cells of the grid.
\begin{claim*}
    For $n$ large, at most $n^2/2$ of the cells of the grid contain a prime $p<\veps n^2$.
\end{claim*}
\begin{proof}
    The number of primes covered is
\[
    \sum_{p<\veps n^2}\left(1+\frac np\right)
    \le\pi(\veps n^2)+2n\sum_{p<\veps n^2}\frac1n+n^2\sum_{p<n}\frac1{p^2}
    <\frac{n^2}2
\]
for sufficiently large $n$.
\end{proof}
\begin{remark}
    Some more details on the estimates: where $s=\veps n^2$, we have
    \begin{align*}
        \pi(s)&=\frac s{\log s}\left(1+O\left(\frac1{\log s}\right)\right)=o\left(n^2\right)\\
        \sum_{p<s}\frac1p&<\sum_{k=1}^s\frac1p=O(\log s)=o(n^2)\\
        \sum_{p<s}\frac1{p^2}&<\sum_p\frac1{p^2}\approx0.452<\frac12.
    \end{align*}
    For curiosity sake, the best bound for the second expression is $\sum_{p<s}\frac1p=\log\log s\cdot(1+o(1))$.
\end{remark}
\begin{remark}
    Here is an easy proof of $\sum_p\frac1{p^2}<\frac12$. Note that \[\sum_{n\text{ odd}}\frac1{n^2}=\sum_n\frac1{n^2}-\sum_{n\text{ even}}\frac1{n^2}=\frac34\cdot\frac{\pi^2}6<\frac54\]
    by $\pi^2<10$. Then \[\sum_p\frac1{p^2}<-\frac1{1^2}+\frac1{2^2}+\sum_{n\text{ odd}}\frac1{n^2}<\frac12.\]
\end{remark}

Hence for some $i$, the row $a+i$ contains at least $n/2$ primes $p\ge \veps n^2$. For $n>\veps^{-1}$, none of the primes divide two numbers of the form $b+j$, so these $n/2$ primes are all distinct. Then \[(a+i)^n>(\veps n^2)^{n/2}=\veps^{n/2}\cdot n^n,\]
as needed.
\begin{remark}
    We prove $\min\{a,b\}>(cn)^n$ instead. The requested bound $(cn)^{n/2}$ is derived by proving primes $p<n$ cover at most $n^2/2$ cells, and using that estimate instead. 
\end{remark}
