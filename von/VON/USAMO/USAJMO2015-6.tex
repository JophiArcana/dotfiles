desc: Stone-moves
source: USAMO 2015/4
tags: [2019-10, oly, easy, combo, invariant]

---

Steve is piling $m\ge 1$ indistinguishable stones on the squares of an $n\times n$ grid. Each square can have an arbitrarily high pile of stones. After he finished piling his stones in some manner, he can perform \emph{stone moves}, defined as follows. Consider any four grid squares, which are corners of a rectangle, i.e.\ in positions $(i,k)$, $(i,l)$, $(j,k)$, $(j,l)$ for some $1\le i,j,k,l\le n$, such that $i<j$ and $k<l$. A stone move consists of either removing one stone from each of $(i,k)$ and $(j,l)$ and moving them to $(i,l)$ and $(j,k)$ respectively, or removing one stone from each of $(i,l)$ and $(j,k)$ are moving them to $(i,k)$ and $(j,l)$ respectively.

Two ways of piling the stones are equivalent if they can be obtained from one another by a sequence of stone moves. How many different non-equivalent ways can Steve pile the stones on the grid?

---

Let the $m$ stones have coordinates $(a_1,b_1)$, $(a_2,b_2)$, $\ldots$, $(a_m,b_m)$. The \emph{signature} $(A,B)$ of the piling is defined by the multisets $A=\{a_i:1\le i\le m\}$ and $B=\{b_i:1\le i\le m\}$. Note that under any stone move, the signature is invariant. Furthermore, each signature determines at least one way of piling the stones: denote by $a_1\le a_2\le\cdots\le a_m$ and $b_1\le b_2\le\cdots\le b_m$ the elements of $A$ and $B$ and let the stones occupy squares $(a_1,b_1)$, $(a_2,b_2)$, $\ldots$, $(a_m,b_m)$.

I contend that two pilings with the same signature are equivalent. Indeed, each stone move sends the points $(a_i,b_i)$ and $(a_j,b_j)$ to $(a_i,b_j)$ and $(a_j,b_i)$ for some $i$ and $j$. Thus we are merely swapping $b_i$ and $b_j$. Since each permutation is obtained by a series of swaps, each signature determines an equivalence class.

Finally, by Stars and Bars there are $\binom{m+n-1}m^2$ possible signatures.

